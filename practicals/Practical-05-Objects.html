<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Practical 5: Objects – Foundations of Spatial Data Science</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="..//img/favicon.ico" rel="icon">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-fb446d74831b8ff67c69632cb314b545.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-c734b2b4d74e7e594e143a63449c09f7.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="Practical 5: Objects – Foundations of Spatial Data Science">
<meta property="og:description" content="From Functions to Classes">
<meta property="og:image" content="img/logo/full_sm.png">
<meta property="og:site_name" content="Foundations">
<meta property="og:locale" content="en_GB">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-md " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../img/logo/logo_only_sm.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Foundations of Spatial Data Science</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../setup/index.html"> 
<span class="menu-text">Setup</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-week-by-week" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Week-by-Week</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-week-by-week">    
        <li>
    <a class="dropdown-item" href="../sessions/index.html">
 <span class="dropdown-text">Overview</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Part 1: Foundations</li>
        <li>
    <a class="dropdown-item" href="../sessions/week1.html">
 <span class="dropdown-text">1. Setting Up</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../sessions/week2.html">
 <span class="dropdown-text">2. Foundations (Pt.1)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../sessions/week3.html">
 <span class="dropdown-text">3. Foundations (Pt.2)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../sessions/week4.html">
 <span class="dropdown-text">4. Efficient Code</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../sessions/week5.html">
 <span class="dropdown-text">5. Objects</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../sessions/reading_week.html">
 <span class="dropdown-text">Reading Week</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Part 2: Process</li>
        <li>
    <a class="dropdown-item" href="../sessions/week6.html">
 <span class="dropdown-text">6. Numeric Data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../sessions/week7.html">
 <span class="dropdown-text">7. Spatial Data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../sessions/week8.html">
 <span class="dropdown-text">8. Textual Data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../sessions/week9.html">
 <span class="dropdown-text">9. Selecting Data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../sessions/week10.html">
 <span class="dropdown-text">10. Presenting Data</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Part 3: Bonus</li>
        <li>
    <a class="dropdown-item" href="../sessions/week11.html">
 <span class="dropdown-text">11. Dimensions in Data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../sessions/week12.html">
 <span class="dropdown-text">12. Grouping Data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../references.html">
 <span class="dropdown-text">Bibliography</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-assessments" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Assessments</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-assessments">    
        <li>
    <a class="dropdown-item" href="../assessments/index.html">
 <span class="dropdown-text">Overview</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Elements</li>
        <li>
    <a class="dropdown-item" href="../assessments/exam.html">
 <span class="dropdown-text">Timed Open Book Exam</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../assessments/group.html">
 <span class="dropdown-text">Group Work</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../assessments/peer.html">
 <span class="dropdown-text">Group Self-Evaluation</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../help.html"> 
<span class="menu-text">Getting Help</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#one-last-time-playing-with-dols" id="toc-one-last-time-playing-with-dols" class="nav-link active" data-scroll-target="#one-last-time-playing-with-dols">One Last Time Playing with DoLs</a></li>
  <li><a href="#appending-a-column" id="toc-appending-a-column" class="nav-link" data-scroll-target="#appending-a-column">Appending a Column</a></li>
  <li><a href="#for-loops-without-for-loops" id="toc-for-loops-without-for-loops" class="nav-link" data-scroll-target="#for-loops-without-for-loops">For Loops Without For Loops</a></li>
  <li><a href="#functionalising" id="toc-functionalising" class="nav-link" data-scroll-target="#functionalising">‘Functionalising’</a></li>
  <li><a href="#decorating" id="toc-decorating" class="nav-link" data-scroll-target="#decorating">Decorating!</a></li>
  <li><a href="#switching-to-object-oriented-code" id="toc-switching-to-object-oriented-code" class="nav-link" data-scroll-target="#switching-to-object-oriented-code">Switching to Object-Oriented Code</a></li>
  <li><a href="#improving-the-documentation" id="toc-improving-the-documentation" class="nav-link" data-scroll-target="#improving-the-documentation">Improving the Documentation</a></li>
  <li><a href="#packaging-it-up" id="toc-packaging-it-up" class="nav-link" data-scroll-target="#packaging-it-up">Packaging It Up</a></li>
  <li><a href="#classes-and-inheritance" id="toc-classes-and-inheritance" class="nav-link" data-scroll-target="#classes-and-inheritance">Classes and Inheritance</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/jreades/fsds/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div><div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="Practical-05-Objects.ipynb" download="Practical-05-Objects.ipynb"><i class="bi bi-journal-code"></i>Jupyter</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Practical 5: Objects</h1>
<p class="subtitle lead">From Functions to Classes</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>This is a very challenging notebook because it takes you <em>both</em> through the process of building a function incrementally <em>and</em> through a ‘simple’ example of how Python classes actually work. You will need to understand these two very different elements in order to make the most of the remaining 6 weeks of term, because we both improve our code incrementally <em>and</em> make use of objects and their inheritances extensively. You also get an extra chance to revisit the differences between LoLs and DoLs because you will undoubtedly encounter and make use of these data structures even <em>after</em> you become a skillfull Python programmer.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>This is a very challenging practical and you should do your best to ensure that you actually understand what you have done and why.</p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Group Sign-Up
</div>
</div>
<div class="callout-body-container callout-body">
<p>You should now make it a priority <a href="https://outlook.office.com/bookwithme/user/056224a5314e48a8ae9805186115b859@ucl.ac.uk/meetingtype/ppQB8pyeHEmCe0u2YNgMHg2?anonymous&amp;ismsaljsauthenabled&amp;ep=mlink">Sign Up</a>!</p>
</div>
</div>
<section id="one-last-time-playing-with-dols" class="level1">
<h1>One Last Time Playing with DoLs</h1>
<p>The preceding practical is hard, so I want to provide <em>another</em> chance for the concepts to bed in before we use them in an <em>object-oriented way through Pandas</em>. Yes, Week 5 will show how we combine concepts covered over the preceding two weeks in <em>practice</em> to begin to ‘do data science’.</p>
<p>First, remember the finding from last week: if we don’t really care about column order, then a dictionary of lists is a nice way to handle data. And why should we care about column order? With our CSV file we saw what a pain it was to fix things when even a tiny thing like the layout of the columns changed.</p>
<p>But if, instead, we could just reference the ‘Description’ column in the data set then it doesn’t matter where that column actually is <em>and</em> we would know that all the descriptions would be <em>text</em>, while all the populations or prices would be <em>numbers</em>. Why is that?</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
🔗 Connections
</div>
</div>
<div class="callout-body-container callout-body">
<p>This task briefly recaps the final part of the previous practical and builds on the <a href="https://jreades.github.io/fsds/sessions/week3.html#pre-recorded-lectures">DOLs to Data</a> and <a href="https://jreades.github.io/fsds/sessions/week4.html#pre-recorded-lectures">Functions</a> lectures.</p>
</div>
</div>
<div id="35f81380" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a>myData <span class="op">=</span> {</span>
<span id="cb1-2"><a href="#cb1-2"></a>    <span class="st">'id'</span>         : [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>],</span>
<span id="cb1-3"><a href="#cb1-3"></a>    <span class="st">'Name'</span>       : [<span class="st">'Gorgeous 2 bed flat w easy access to Earlsfiel...'</span>, <span class="st">'Welcome to London!'</span>, <span class="st">'2 bedroom 8th floor serviced apartment.'</span>,<span class="st">'Prime city studio apartment'</span>,<span class="st">'Cozy Room near Canary Wharf'</span>],</span>
<span id="cb1-4"><a href="#cb1-4"></a>    <span class="st">'Longitude'</span>  : [<span class="op">-</span><span class="fl">0.189030</span>, <span class="op">-</span><span class="fl">0.093411</span>, <span class="op">-</span><span class="fl">0.022240</span>, <span class="op">-</span><span class="fl">0.078328</span>, <span class="op">-</span><span class="fl">0.029900</span>],</span>
<span id="cb1-5"><a href="#cb1-5"></a>    <span class="st">'Latitude'</span>   : [<span class="fl">51.442430</span>, <span class="fl">51.593397</span>, <span class="fl">51.499260</span>, <span class="fl">51.525488</span>, <span class="fl">51.514680</span>],</span>
<span id="cb1-6"><a href="#cb1-6"></a>    <span class="st">'Bedrooms'</span>   : [<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">3</span>],</span>
<span id="cb1-7"><a href="#cb1-7"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To print out a list of every city in the data set:</p>
<div id="3cc6a138" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a><span class="bu">print</span>(<span class="st">", "</span>.join(myData[<span class="st">'Name'</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Gorgeous 2 bed flat w easy access to Earlsfiel..., Welcome to London!, 2 bedroom 8th floor serviced apartment., Prime city studio apartment, Cozy Room near Canary Wharf</code></pre>
</div>
</div>
<p>To find out if <code>Out in Dalston</code> is included in the list of data:</p>
<div id="4cc213d7" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a><span class="cf">if</span> <span class="st">'Out in Dalston'</span> <span class="kw">in</span> myData[<span class="st">'Name'</span>]:</span>
<span id="cb4-2"><a href="#cb4-2"></a>    <span class="bu">print</span>(<span class="st">"Found 'Out in Dalston' in the data set!"</span>)</span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="cf">else</span>:</span>
<span id="cb4-4"><a href="#cb4-4"></a>    <span class="bu">print</span>(<span class="st">"Didn't find 'Out in Dalston' in the data set."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Didn't find 'Out in Dalston' in the data set.</code></pre>
</div>
</div>
<p>See how even basic questions like “Is X in our data set?” are now easy (and quick) to answer? We no longer need to loop over the entire data set in order to find one data point. In addition, we know that everything in the ‘Name’ column will be a string, and that everything in the ‘Longitude’ column is a float, while the ‘Bedrooms’ column contains integers. So that’s made life easier already. But let’s test this out and see how it works.</p>
</section>
<section id="appending-a-column" class="level1">
<h1>Appending a Column</h1>
<section id="calculate-mean" class="level2">
<h2 class="anchored" data-anchor-id="calculate-mean">Calculate Mean</h2>
<p>Let’s start by calculating the sample mean (use Google: <code>Python numpy mean...</code>):</p>
<div class="tabset-margin-container"></div><div class="panel-tabset qna-question">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Question</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Answer</a></li></ul>
<div class="tab-content qna-question">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="sourceCode" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a><span class="im">import</span> numpy <span class="im">as</span> ??</span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="co"># Use numpy function to calculate mean</span></span>
<span id="cb6-3"><a href="#cb6-3"></a>mean <span class="op">=</span> ??.??(myData[<span class="st">'Bedrooms'</span>])</span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="bu">print</span>(<span class="ss">f"The mean. number of bedrooms is </span><span class="sc">{</span>mean<span class="sc">:,.1f}</span><span class="ss">."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="co"># Use numpy function to calculate mean</span></span>
<span id="cb7-3"><a href="#cb7-3"></a>mean <span class="op">=</span> np.mean(myData[<span class="st">'Bedrooms'</span>])</span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="bu">print</span>(<span class="ss">f"The mean. number of bedrooms is </span><span class="sc">{</span>mean<span class="sc">:,.1f}</span><span class="ss">."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>The mean. number of bedrooms is 1.8.</code></pre>
</div>
</div>
</div>
</section>
<section id="calculate-standard-deviation" class="level2">
<h2 class="anchored" data-anchor-id="calculate-standard-deviation">Calculate Standard Deviation</h2>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Difficulty level: Low-ish.
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">

</div>
</div>
</div>
<p>Now let’s do the standard deviation:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset qna-question">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Question</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Answer</a></li></ul>
<div class="tab-content qna-question">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="sourceCode" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="co"># Use a numpy function to calculate the standard deviation</span></span>
<span id="cb9-3"><a href="#cb9-3"></a>std  <span class="op">=</span> np.??(??)</span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="bu">print</span>(<span class="ss">f"The standard deviation of bedrooms is </span><span class="sc">{</span>std<span class="sc">:,.2f}</span><span class="ss">."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="co"># Use a numpy function to calculate the standard deviation</span></span>
<span id="cb10-3"><a href="#cb10-3"></a>std  <span class="op">=</span> np.std( myData[<span class="st">'Bedrooms'</span>] )</span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="bu">print</span>(<span class="ss">f"The standard deviation of bedrooms is </span><span class="sc">{</span>std<span class="sc">:,.2f}</span><span class="ss">."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>The standard deviation of bedrooms is 0.75.</code></pre>
</div>
</div>
</div>
<p>So the <code>numpy</code> package gives us a way to calculate the mean and standard deviation <em>quickly</em> and without having to reinvent the wheel. The other potentially new thing here is <code>{std:,.2f}</code>. This is about <a href="https://www.w3schools.com/python/ref_string_format.asp">string formatting</a> and the main thing to recognise is that this means ‘format this float with commas separating the thousands/millions and 2 digits to the right’. The link I’ve provided uses the slightly older approach of <code>&lt;str&gt;.format()</code> but the formatting approach is the same.</p>
</section>
</section>
<section id="for-loops-without-for-loops" class="level1">
<h1>For Loops Without For Loops</h1>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Difficulty level: Medium.
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">

</div>
</div>
</div>
<p>Now we’re going to see something called a <strong>List Comprehension</strong>.</p>
<p>In Python you will see code like this a lot: <code>[x for x in list]</code>. This syntax is known as a ‘list comprehension’ and is basically a <code>for</code> loop on one line with the output being assigned to a list. So we can apply an operation (converting to a string, subtracting a value, etc.) to every item in a list without writing out a full for loop.</p>
<p>Here’s a quick example just to show you what’s going on:</p>
<div id="b27df8d8" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1"></a>demo <span class="op">=</span> <span class="bu">range</span>(<span class="dv">0</span>,<span class="dv">10</span>) <span class="co"># &lt;- a *range* of numbers between 0 and 9 (stop at 10)</span></span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="bu">print</span>([x<span class="op">**</span><span class="dv">2</span> <span class="cf">for</span> x <span class="kw">in</span> demo]) <span class="co"># square every element of demo</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[0, 1, 4, 9, 16, 25, 36, 49, 64, 81]</code></pre>
</div>
</div>
<p>Now let’s apply this to our problem. We calculated the the mean and standard deviation above, so now we want to apply the z-score formula to every element of the Population list… Remember that the format for the z-score (when dealing with a sample) is:</p>
<p><span class="math display">\[
z = \frac{x - \bar{x}}{s}
\]</span></p>
<p>And the population standard deviation (by which I mean, if you are dealing with <em>all</em> the data, and not a subsample as we are here) is:</p>
<p><span class="math display">\[
z = \frac{x - \mu}{\sigma}
\]</span></p>
<div class="tabset-margin-container"></div><div class="panel-tabset qna-question">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Question</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Answer</a></li></ul>
<div class="tab-content qna-question">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="sourceCode" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1"></a>rs <span class="op">=</span> [(x <span class="op">-</span> ??)<span class="op">/</span>?? <span class="cf">for</span> x <span class="kw">in</span> myData[<span class="st">'Bedrooms'</span>]] <span class="co"># rs == result set</span></span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="bu">print</span>([<span class="ss">f"</span><span class="sc">{</span>x<span class="sc">:.3f}</span><span class="ss">"</span> <span class="cf">for</span> x <span class="kw">in</span> rs])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1"></a>rs <span class="op">=</span> [(x <span class="op">-</span> mean)<span class="op">/</span>std <span class="cf">for</span> x <span class="kw">in</span> myData[<span class="st">'Bedrooms'</span>]] <span class="co"># rs == result set</span></span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="bu">print</span>([<span class="ss">f"</span><span class="sc">{</span>x<span class="sc">:.3f}</span><span class="ss">"</span> <span class="cf">for</span> x <span class="kw">in</span> rs])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>['0.267', '-1.069', '0.267', '-1.069', '1.604']</code></pre>
</div>
</div>
</div>
<section id="appending" class="level2">
<h2 class="anchored" data-anchor-id="appending">Appending</h2>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Difficulty level: trivial
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">

</div>
</div>
</div>
<p>And now let’s add it to the data set:</p>
<div id="684bec74" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1"></a>myData[<span class="st">'Std. Bedrooms'</span>] <span class="op">=</span> rs</span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="bu">print</span>(myData[<span class="st">'Std. Bedrooms'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[0.2672612419124243, -1.0690449676496976, 0.2672612419124243, -1.0690449676496976, 1.6035674514745462]</code></pre>
</div>
</div>
<p>And just to show how everything is in a single data structure:</p>
<div id="5593c265" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1"></a><span class="cf">for</span> c <span class="kw">in</span> myData[<span class="st">'Name'</span>]:</span>
<span id="cb19-2"><a href="#cb19-2"></a>    idx <span class="op">=</span> myData[<span class="st">'Name'</span>].index(c)</span>
<span id="cb19-3"><a href="#cb19-3"></a>    <span class="bu">print</span>(<span class="ss">f"Listing </span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> has </span><span class="sc">{</span>myData[<span class="st">'Bedrooms'</span>][idx]<span class="sc">:,}</span><span class="ss"> bedrooms and standardised score of </span><span class="sc">{</span>myData[<span class="st">'Std. Bedrooms'</span>][idx]<span class="sc">:.3f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Listing Gorgeous 2 bed flat w easy access to Earlsfiel... has 2 bedrooms and standardised score of 0.267
Listing Welcome to London! has 1 bedrooms and standardised score of -1.069
Listing 2 bedroom 8th floor serviced apartment. has 2 bedrooms and standardised score of 0.267
Listing Prime city studio apartment has 1 bedrooms and standardised score of -1.069
Listing Cozy Room near Canary Wharf has 3 bedrooms and standardised score of 1.604</code></pre>
</div>
</div>
</section>
</section>
<section id="functionalising" class="level1">
<h1>‘Functionalising’</h1>
<p>Let’s start trying to pull what we’ve learned over the past two weeks together by creating a function that will download a file from a URL (checking if it has already <em>been</em> downloaded to save bandwidth).</p>
<p>To be honest, there’s not going to be much about writing our <em>own</em> objects here, but we will be making use of them and, conceptually, an understanding of objects and classes is going to be super-useful for understanding what we’re doing in the remainder of the term!</p>
<section id="downloading-from-a-url" class="level2">
<h2 class="anchored" data-anchor-id="downloading-from-a-url">Downloading from a URL</h2>
<p>Let’s focus on the first part <em>first</em> because that’s the precondition for everything else. If we can get the ‘download a file from a URL’ working then the rest will gradually fall into place through <em>iterative</em> improvments!</p>
<section id="finding-an-existing-answer" class="level3">
<h3 class="anchored" data-anchor-id="finding-an-existing-answer">Finding an Existing Answer</h3>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Difficulty level: Low
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">

</div>
</div>
</div>
<p>First, let’s be sensibly lazy–we’ve already written code to read a file from the Internet and save it locally. We’re going to start from this point.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1"></a><span class="im">from</span> urllib.request <span class="im">import</span> URLError</span>
<span id="cb21-2"><a href="#cb21-2"></a><span class="im">from</span> urllib.request <span class="im">import</span> urlopen</span>
<span id="cb21-3"><a href="#cb21-3"></a></span>
<span id="cb21-4"><a href="#cb21-4"></a><span class="cf">try</span>:</span>
<span id="cb21-5"><a href="#cb21-5"></a>    url <span class="op">=</span> <span class="st">'https://orca.casa.ucl.ac.uk/~jreades/data/Listings.csv'</span></span>
<span id="cb21-6"><a href="#cb21-6"></a>    response <span class="op">=</span> urlopen(url)</span>
<span id="cb21-7"><a href="#cb21-7"></a>    raw  <span class="op">=</span> response.read()</span>
<span id="cb21-8"><a href="#cb21-8"></a>    data <span class="op">=</span> raw.decode(<span class="st">'utf-8'</span>)</span>
<span id="cb21-9"><a href="#cb21-9"></a>    <span class="cf">with</span> <span class="bu">open</span>(<span class="st">'Listings.csv'</span>, <span class="st">'w'</span>) <span class="im">as</span> f:</span>
<span id="cb21-10"><a href="#cb21-10"></a>        f.writelines(data)</span>
<span id="cb21-11"><a href="#cb21-11"></a><span class="cf">except</span> URLError <span class="im">as</span> e:</span>
<span id="cb21-12"><a href="#cb21-12"></a>    <span class="bu">print</span>(<span class="ss">f"Unable to download data: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="getting-organised" class="level3">
<h3 class="anchored" data-anchor-id="getting-organised">Getting Organised</h3>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Difficulty level: Low
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">

</div>
</div>
</div>
<p>Let’s take the code above and modify it so that it is:</p>
<ol type="1">
<li>A function that takes two arguments: a URL and a destination filename.</li>
<li>A function that checks if a file exists already before downloading it again.</li>
</ol>
<p>You will find that the <code>os</code> module helps here because of the <code>path</code> function. And you will <a href="https://lmgtfy.app/?q=check+if+file+exists+python">need to Google</a> how to test if a file exists. I would normally select a StackOverflow link in the results list over anything else because there will normally be an <em>explanation</em> included of why a particular answer is a ‘good one’. I also look at which answers got the most votes (not always the same as the one that was the ‘accepted answer’). In this particular case, I also found <a href="https://careerkarma.com/blog/python-check-if-file-exists/">this answer</a> useful.</p>
<p>I would start by setting my inputs:</p>
<div id="a6098afe" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1"></a><span class="im">import</span> os</span>
<span id="cb22-2"><a href="#cb22-2"></a>url <span class="op">=</span> <span class="st">"https://orca.casa.ucl.ac.uk/~jreades/data/Listings.csv"</span></span>
<span id="cb22-3"><a href="#cb22-3"></a>out <span class="op">=</span> os.path.join(<span class="st">'data'</span>,<span class="st">'Listings.csv'</span>) <span class="co"># Print `out` if you aren't sure what this has done!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="sketching-the-function" class="level3">
<h3 class="anchored" data-anchor-id="sketching-the-function">Sketching the Function</h3>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Difficulty level: Low, if you’ve watched the videos…
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">

</div>
</div>
</div>
<p>Then I would sketch out how my function will work using comments. And the simplest thing to start with is checking whether the file has already been downloaded:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset qna-question">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Question</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Answer</a></li></ul>
<div class="tab-content qna-question">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="sourceCode" id="cb23"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1"></a><span class="im">from</span> urllib.request <span class="im">import</span> urlopen</span>
<span id="cb23-2"><a href="#cb23-2"></a></span>
<span id="cb23-3"><a href="#cb23-3"></a><span class="kw">def</span> get_url(src, dest):</span>
<span id="cb23-4"><a href="#cb23-4"></a>    </span>
<span id="cb23-5"><a href="#cb23-5"></a>    <span class="co"># Check if dest exists -- if it does</span></span>
<span id="cb23-6"><a href="#cb23-6"></a>    <span class="co"># then we can skip downloading the file,</span></span>
<span id="cb23-7"><a href="#cb23-7"></a>    <span class="co"># otherwise we have to download it!</span></span>
<span id="cb23-8"><a href="#cb23-8"></a>    <span class="cf">if</span> os.path.isfile(??):</span>
<span id="cb23-9"><a href="#cb23-9"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>dest<span class="sc">}</span><span class="ss"> found!"</span>)</span>
<span id="cb23-10"><a href="#cb23-10"></a>    <span class="cf">else</span>:</span>
<span id="cb23-11"><a href="#cb23-11"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>dest<span class="sc">}</span><span class="ss"> *not* found!"</span>)</span>
<span id="cb23-12"><a href="#cb23-12"></a>        </span>
<span id="cb23-13"><a href="#cb23-13"></a>get_url(url, out)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1"></a><span class="im">from</span> urllib.request <span class="im">import</span> urlopen</span>
<span id="cb24-2"><a href="#cb24-2"></a></span>
<span id="cb24-3"><a href="#cb24-3"></a><span class="kw">def</span> get_url(src, dest):</span>
<span id="cb24-4"><a href="#cb24-4"></a></span>
<span id="cb24-5"><a href="#cb24-5"></a>    <span class="co"># Check if dest exists -- if it does</span></span>
<span id="cb24-6"><a href="#cb24-6"></a>    <span class="co"># then we can skip downloading the file,</span></span>
<span id="cb24-7"><a href="#cb24-7"></a>    <span class="co"># otherwise we have to download it!</span></span>
<span id="cb24-8"><a href="#cb24-8"></a>    <span class="cf">if</span> os.path.isfile(dest):</span>
<span id="cb24-9"><a href="#cb24-9"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>dest<span class="sc">}</span><span class="ss"> found!"</span>)</span>
<span id="cb24-10"><a href="#cb24-10"></a>    <span class="cf">else</span>:</span>
<span id="cb24-11"><a href="#cb24-11"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>dest<span class="sc">}</span><span class="ss"> *not* found!"</span>)</span>
<span id="cb24-12"><a href="#cb24-12"></a></span>
<span id="cb24-13"><a href="#cb24-13"></a>get_url(url, out)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>data/Listings.csv found!</code></pre>
</div>
</div>
</div>
</section>
<section id="fleshing-out-the-function" class="level3">
<h3 class="anchored" data-anchor-id="fleshing-out-the-function">Fleshing Out the Function</h3>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Difficulty level: Medium
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>If you really explore what’s going on in the function rather than just running it and moving on.</p>
</div>
</div>
</div>
<p>I would then flesh out the code so that it downloads the file if it isn’t found and then, either way, returns the <em>local</em> file path for our CSV reader to extract:</p>
<div id="a100c7ef" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1"></a><span class="kw">def</span> get_url(src, dest):</span>
<span id="cb26-2"><a href="#cb26-2"></a>    </span>
<span id="cb26-3"><a href="#cb26-3"></a>    <span class="co"># Check if dest does *not* exist -- that</span></span>
<span id="cb26-4"><a href="#cb26-4"></a>    <span class="co"># would mean we had to download it!</span></span>
<span id="cb26-5"><a href="#cb26-5"></a>    <span class="cf">if</span> os.path.isfile(dest):</span>
<span id="cb26-6"><a href="#cb26-6"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>dest<span class="sc">}</span><span class="ss"> found locally!"</span>)</span>
<span id="cb26-7"><a href="#cb26-7"></a>    <span class="cf">else</span>:</span>
<span id="cb26-8"><a href="#cb26-8"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>dest<span class="sc">}</span><span class="ss"> not found, downloading!"</span>)</span>
<span id="cb26-9"><a href="#cb26-9"></a>        </span>
<span id="cb26-10"><a href="#cb26-10"></a>        <span class="co">#&nbsp;Get the data using the urlopen function</span></span>
<span id="cb26-11"><a href="#cb26-11"></a>        response <span class="op">=</span> urlopen(src) </span>
<span id="cb26-12"><a href="#cb26-12"></a>        filedata <span class="op">=</span> response.read().decode(<span class="st">'utf-8'</span>)</span>
<span id="cb26-13"><a href="#cb26-13"></a>        </span>
<span id="cb26-14"><a href="#cb26-14"></a>        <span class="co"># Extract the part of the dest(ination) that is *not*</span></span>
<span id="cb26-15"><a href="#cb26-15"></a>        <span class="co"># the actual filename--have a look at how </span></span>
<span id="cb26-16"><a href="#cb26-16"></a>        <span class="co"># os.path.split works using `help(os.path.split)`</span></span>
<span id="cb26-17"><a href="#cb26-17"></a>        path <span class="op">=</span> <span class="bu">list</span>(os.path.split(dest)[:<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb26-18"><a href="#cb26-18"></a>        </span>
<span id="cb26-19"><a href="#cb26-19"></a>        <span class="co"># Create any missing directories in dest(ination) path</span></span>
<span id="cb26-20"><a href="#cb26-20"></a>        <span class="co"># -- os.path.join is the reverse of split (as you saw above)</span></span>
<span id="cb26-21"><a href="#cb26-21"></a>        <span class="co"># but it doesn't work with lists... so I had to google how </span></span>
<span id="cb26-22"><a href="#cb26-22"></a>        <span class="co"># to use the 'splat' operator! os.makedirs creates missing </span></span>
<span id="cb26-23"><a href="#cb26-23"></a>        <span class="co"># directories in a path automatically.</span></span>
<span id="cb26-24"><a href="#cb26-24"></a>        <span class="cf">if</span> <span class="bu">len</span>(path) <span class="op">&gt;=</span> <span class="dv">1</span> <span class="kw">and</span> path[<span class="dv">0</span>] <span class="op">!=</span> <span class="st">''</span>:</span>
<span id="cb26-25"><a href="#cb26-25"></a>            os.makedirs(os.path.join(<span class="op">*</span>path), exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb26-26"><a href="#cb26-26"></a>        </span>
<span id="cb26-27"><a href="#cb26-27"></a>        <span class="cf">with</span> <span class="bu">open</span>(dest, <span class="st">'w'</span>) <span class="im">as</span> f:</span>
<span id="cb26-28"><a href="#cb26-28"></a>            f.write(filedata)</span>
<span id="cb26-29"><a href="#cb26-29"></a>            </span>
<span id="cb26-30"><a href="#cb26-30"></a>        <span class="bu">print</span>(<span class="ss">f"Data written to </span><span class="sc">{</span>dest<span class="sc">}</span><span class="ss">!"</span>)</span>
<span id="cb26-31"><a href="#cb26-31"></a>    </span>
<span id="cb26-32"><a href="#cb26-32"></a>    <span class="cf">return</span> dest</span>
<span id="cb26-33"><a href="#cb26-33"></a>        </span>
<span id="cb26-34"><a href="#cb26-34"></a><span class="co"># Using the `return contents` line we make it easy to </span></span>
<span id="cb26-35"><a href="#cb26-35"></a><span class="co"># see what our function is up to.</span></span>
<span id="cb26-36"><a href="#cb26-36"></a>src <span class="op">=</span> get_url(url, out)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>data/Listings.csv found locally!</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="decorating" class="level1">
<h1>Decorating!</h1>
<p>Let’s now look into simplifying this code using a dectorator! Our function has become a bit unwieldy and we want to look at how we can simplify that.</p>
<p>The ‘obvious’ (i.e.&nbsp;not obvious) way to do this is to implement the check for a local copy as a decorator on the downloading function. So we have a function that downloads, and a decorator function that checks if the download should even be triggered.</p>
<div id="bfdbb666" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1"></a><span class="im">from</span> functools <span class="im">import</span> wraps</span>
<span id="cb28-2"><a href="#cb28-2"></a><span class="kw">def</span> check_cache(f):</span>
<span id="cb28-3"><a href="#cb28-3"></a>    <span class="at">@wraps</span>(f)</span>
<span id="cb28-4"><a href="#cb28-4"></a>    <span class="kw">def</span> wrapper(<span class="op">*</span>args, <span class="op">**</span>kwargs):</span>
<span id="cb28-5"><a href="#cb28-5"></a>        src  <span class="op">=</span> args[<span class="dv">0</span>]</span>
<span id="cb28-6"><a href="#cb28-6"></a>        dest <span class="op">=</span> args[<span class="dv">1</span>]</span>
<span id="cb28-7"><a href="#cb28-7"></a>        <span class="cf">if</span> os.path.isfile(dest):</span>
<span id="cb28-8"><a href="#cb28-8"></a>            <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>dest<span class="sc">}</span><span class="ss"> found locally!"</span>)</span>
<span id="cb28-9"><a href="#cb28-9"></a>            <span class="cf">return</span>(dest)</span>
<span id="cb28-10"><a href="#cb28-10"></a>        <span class="cf">else</span>:</span>
<span id="cb28-11"><a href="#cb28-11"></a>            <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>dest<span class="sc">}</span><span class="ss"> not found, downloading!"</span>)</span>
<span id="cb28-12"><a href="#cb28-12"></a>            <span class="cf">return</span>(f(src, dest))</span>
<span id="cb28-13"><a href="#cb28-13"></a>    <span class="cf">return</span> wrapper</span>
<span id="cb28-14"><a href="#cb28-14"></a></span>
<span id="cb28-15"><a href="#cb28-15"></a><span class="at">@check_cache</span></span>
<span id="cb28-16"><a href="#cb28-16"></a><span class="kw">def</span> get_url(src, dest):    </span>
<span id="cb28-17"><a href="#cb28-17"></a>    <span class="co">#&nbsp;Get the data using the urlopen function</span></span>
<span id="cb28-18"><a href="#cb28-18"></a>    response <span class="op">=</span> urlopen(src) </span>
<span id="cb28-19"><a href="#cb28-19"></a>    filedata <span class="op">=</span> response.read().decode(<span class="st">'utf-8'</span>)</span>
<span id="cb28-20"><a href="#cb28-20"></a>     </span>
<span id="cb28-21"><a href="#cb28-21"></a>    <span class="co"># Extract the part of the dest(ination) that is *not*</span></span>
<span id="cb28-22"><a href="#cb28-22"></a>    <span class="co"># the actual filename--have a look at how </span></span>
<span id="cb28-23"><a href="#cb28-23"></a>    <span class="co"># os.path.split works using `help(os.path.split)`</span></span>
<span id="cb28-24"><a href="#cb28-24"></a>    path <span class="op">=</span> <span class="bu">list</span>(os.path.split(dest)[:<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb28-25"><a href="#cb28-25"></a>     </span>
<span id="cb28-26"><a href="#cb28-26"></a>    <span class="co"># Create any missing directories in dest(ination) path</span></span>
<span id="cb28-27"><a href="#cb28-27"></a>    <span class="co"># -- os.path.join is the reverse of split (as you saw above)</span></span>
<span id="cb28-28"><a href="#cb28-28"></a>    <span class="co"># but it doesn't work with lists... so I had to google how </span></span>
<span id="cb28-29"><a href="#cb28-29"></a>    <span class="co"># to use the 'splat' operator! os.makedirs creates missing </span></span>
<span id="cb28-30"><a href="#cb28-30"></a>    <span class="co"># directories in a path automatically.</span></span>
<span id="cb28-31"><a href="#cb28-31"></a>    <span class="cf">if</span> <span class="bu">len</span>(path) <span class="op">&gt;=</span> <span class="dv">1</span> <span class="kw">and</span> path[<span class="dv">0</span>] <span class="op">!=</span> <span class="st">''</span>:</span>
<span id="cb28-32"><a href="#cb28-32"></a>        os.makedirs(os.path.join(<span class="op">*</span>path), exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb28-33"><a href="#cb28-33"></a>     </span>
<span id="cb28-34"><a href="#cb28-34"></a>    <span class="cf">with</span> <span class="bu">open</span>(dest, <span class="st">'w'</span>) <span class="im">as</span> f:</span>
<span id="cb28-35"><a href="#cb28-35"></a>        f.write(filedata)</span>
<span id="cb28-36"><a href="#cb28-36"></a>         </span>
<span id="cb28-37"><a href="#cb28-37"></a>    <span class="bu">print</span>(<span class="ss">f"Data written to </span><span class="sc">{</span>dest<span class="sc">}</span><span class="ss">!"</span>)</span>
<span id="cb28-38"><a href="#cb28-38"></a>    </span>
<span id="cb28-39"><a href="#cb28-39"></a>    <span class="cf">return</span> dest</span>
<span id="cb28-40"><a href="#cb28-40"></a>        </span>
<span id="cb28-41"><a href="#cb28-41"></a><span class="co"># Using the `return contents` line we make it easy to </span></span>
<span id="cb28-42"><a href="#cb28-42"></a><span class="co"># see what our function is up to.</span></span>
<span id="cb28-43"><a href="#cb28-43"></a>src <span class="op">=</span> get_url(url, out)</span>
<span id="cb28-44"><a href="#cb28-44"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>src<span class="sc">}</span><span class="ss"> is a </span><span class="sc">{</span><span class="bu">type</span>(src)<span class="sc">}</span><span class="ss">."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>data/Listings.csv found locally!
data/Listings.csv is a &lt;class 'str'&gt;.</code></pre>
</div>
</div>
<p>I’m not going to pretend that’s the <em>best</em> use of a decorator, but it <em>does</em> neatly separate the downloading function from the caching function. In fact, there is already a <a href="https://pvsravanth.medium.com/speeding-up-your-python-code-with-the-cache-decorator-from-functools-bce4731eed69">cache decorator</a> and some of these have unlimited capacity; however, they are intended to run in a ‘live’ context, so you’d still need to download the file again any time you start a new notebook or restart Podman. <em>This</em> caching function saves the actual data locally to <code>dest</code>.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Stop!
</div>
</div>
<div class="callout-body-container callout-body">
<p>It really would be a good idea to put in the effort to make sense of how this function works. There is a lot going on here and understanding how this function works will help you to understand how to code. You should notice that we don’t try to check if the data file contains any useful data! So if you download or create an empty file while testing, you won’t necessarily get an error until you try to turn it into data afterwards!</p>
</div>
</div>
</section>
<section id="switching-to-object-oriented-code" class="level1">
<h1>Switching to Object-Oriented Code</h1>
<p>While the <code>os</code> package is still widely used, not long ago the people who contributed to Python decided that it would be better to be consistent and that paths (file and directory locations) on computers should use an object-oriented approach too. So all Python code will gradually shift to using <code>pathlib</code> instead and this is a good place to demonstrate why going object-oriented is a <em>choice</em> and not a <em>requirement</em>.</p>
<section id="pathlib" class="level2">
<h2 class="anchored" data-anchor-id="pathlib">Pathlib</h2>
<p>Pathlib is intended to work around the fact that different Operating Systems represent paths on file systems in different ways. Using the <code>os</code> library there is quite a lot of ‘faff’ involved in managing this: whereas Unix, Linux, and the macOS (which is BSD Unix under the hood) use forward slashes in a path (e.g.&nbsp;<code>/Users/&lt;username&gt;/Documents/...</code>)<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>, Windows usess backslashes (e.g.&nbsp;<code>C:\Users\&lt;username&gt;\My Documents\...</code>). The differences don’t stop there, but that’s enough to see how life can get complicated; in <code>os</code> this is managed by the bundle of functions and constants under <code>os.path</code> and you can then use <code>os.path.sep.join([&lt;a list representing a path on the computer&gt;])</code>.</p>
<p>Pathlib does away with all of that. Remember that we’ve defined an object as a bundle of data and functions that act on the data. So the <code>Path</code> class is <em>both</em> data about a location on a computer <em>and</em> a set of functions that can manipulate that data. Let’s see what that means in practice:</p>
<div id="04a9a457" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb30-2"><a href="#cb30-2"></a></span>
<span id="cb30-3"><a href="#cb30-3"></a>here <span class="op">=</span> Path(<span class="st">'.'</span>)</span>
<span id="cb30-4"><a href="#cb30-4"></a><span class="bu">print</span>(<span class="st">"Using a directory: "</span>)</span>
<span id="cb30-5"><a href="#cb30-5"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\t</span><span class="ss">Here: </span><span class="sc">{</span>here<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb30-6"><a href="#cb30-6"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\t</span><span class="ss">Parents: </span><span class="sc">{</span>here<span class="sc">.</span>parents<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb30-7"><a href="#cb30-7"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\t</span><span class="ss">URI: </span><span class="sc">{</span>here<span class="sc">.</span>absolute()<span class="sc">.</span>as_uri()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb30-8"><a href="#cb30-8"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\t</span><span class="ss">Is directory: </span><span class="sc">{</span>here<span class="sc">.</span>is_dir()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb30-9"><a href="#cb30-9"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\t</span><span class="ss">Is file: </span><span class="sc">{</span>here<span class="sc">.</span>is_file()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb30-10"><a href="#cb30-10"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\t</span><span class="ss">Parts: </span><span class="sc">{</span>here<span class="sc">.</span>resolve()<span class="sc">.</span>parts<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb30-11"><a href="#cb30-11"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\t</span><span class="ss">Directory contents: </span><span class="ch">\n\t\t</span><span class="sc">{</span><span class="st">'</span><span class="ch">\n\t\t</span><span class="st">'</span><span class="sc">.</span>join([<span class="bu">str</span>(x) <span class="cf">for</span> x <span class="kw">in</span> <span class="bu">list</span>(here.glob(<span class="st">'*.qmd'</span>))[:<span class="dv">3</span>]])<span class="sc">}</span><span class="ss">..."</span>)</span>
<span id="cb30-12"><a href="#cb30-12"></a></span>
<span id="cb30-13"><a href="#cb30-13"></a><span class="bu">print</span>()</span>
<span id="cb30-14"><a href="#cb30-14"></a></span>
<span id="cb30-15"><a href="#cb30-15"></a>fn <span class="op">=</span> here <span class="op">/</span> <span class="st">'Practical-05-Objects.qmd'</span></span>
<span id="cb30-16"><a href="#cb30-16"></a><span class="bu">print</span>(<span class="st">"Using a file:"</span>)</span>
<span id="cb30-17"><a href="#cb30-17"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\t</span><span class="ss">Resolved path: </span><span class="sc">{</span>fn<span class="sc">.</span>resolve()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb30-18"><a href="#cb30-18"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\t</span><span class="ss">Exists: </span><span class="sc">{</span>fn<span class="sc">.</span>exists()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb30-19"><a href="#cb30-19"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\t</span><span class="ss">Is file: </span><span class="sc">{</span>fn<span class="sc">.</span>is_file()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb30-20"><a href="#cb30-20"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\t</span><span class="ss">File size (bytes): </span><span class="sc">{</span>fn<span class="sc">.</span>stat()<span class="sc">.</span>st_size<span class="sc">:,}</span><span class="ss"> bytes"</span>)</span>
<span id="cb30-21"><a href="#cb30-21"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\t</span><span class="ss">Owner: </span><span class="sc">{</span>fn<span class="sc">.</span>owner()<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Using a directory: 
    Here: .
    Parents: &lt;PosixPath.parents&gt;
    URI: file:///Users/jreades/Documents/git/fsds/practicals
    Is directory: True
    Is file: False
    Parts: ('/', 'Users', 'jreades', 'Documents', 'git', 'fsds', 'practicals')
    Directory contents: 
        Practical-03-Foundations_2.qmd
        Practical-08-Textual_Data-Pt2.qmd
        Practical-09-Selecting_Data.qmd...

Using a file:
    Resolved path: /Users/jreades/Documents/git/fsds/practicals/Practical-05-Objects.qmd
    Exists: True
    Is file: True
    File size (bytes): 34,545 bytes
    Owner: jreades</code></pre>
</div>
</div>
<p>Hopefully you can now see how the object-oriented approach of <code>pathlib</code> allows to write neater, more readable code than the older <code>os</code> module? We no longer have to keep passing in a list or string representing a path on a specific operating system, we can just pass around Path objects and let Python take care of turning them into concrete paths on a computer when we need to ‘act’ on the Path in some way (check that it exists, create it, interrogate it, etc.).</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Updating…
</div>
</div>
<div class="callout-body-container callout-body">
<p>In fact, I’m still updating the practicals to make full use of <code>pathlib</code> so you may find places where the older <code>os</code> approach is still in use. If you spot one of these why not submit an <a href="https://github.com/jreades/fsds/issues">Issue</a> or even fix it in a copy of the FSDS repor and then submit a <a href="https://github.com/jreades/fsds/pulls">Pull Request</a> on GitHub to correct the code?</p>
</div>
</div>
</section>
<section id="updating-the-function" class="level2">
<h2 class="anchored" data-anchor-id="updating-the-function">Updating the Function</h2>
<p>So let’s update the function to move from <code>os</code> to <code>pathlib</code> and see how things change…</p>
<div id="737355b7" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1"></a><span class="im">from</span> functools <span class="im">import</span> wraps</span>
<span id="cb32-2"><a href="#cb32-2"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb32-3"><a href="#cb32-3"></a><span class="kw">def</span> check_cache(f):</span>
<span id="cb32-4"><a href="#cb32-4"></a>    <span class="at">@wraps</span>(f)</span>
<span id="cb32-5"><a href="#cb32-5"></a>    <span class="kw">def</span> wrapper(<span class="op">*</span>args, <span class="op">**</span>kwargs):</span>
<span id="cb32-6"><a href="#cb32-6"></a>        src  <span class="op">=</span> Path(args[<span class="dv">0</span>])</span>
<span id="cb32-7"><a href="#cb32-7"></a>        dest <span class="op">=</span> Path(args[<span class="dv">1</span>])</span>
<span id="cb32-8"><a href="#cb32-8"></a>        <span class="cf">if</span> dest.exists() <span class="kw">and</span> dest.is_file():</span>
<span id="cb32-9"><a href="#cb32-9"></a>            <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>dest<span class="sc">}</span><span class="ss"> found locally!"</span>)</span>
<span id="cb32-10"><a href="#cb32-10"></a>            <span class="cf">return</span>(dest)</span>
<span id="cb32-11"><a href="#cb32-11"></a>        <span class="cf">else</span>:</span>
<span id="cb32-12"><a href="#cb32-12"></a>            <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>dest<span class="sc">}</span><span class="ss"> not found, downloading!"</span>)</span>
<span id="cb32-13"><a href="#cb32-13"></a>            <span class="cf">return</span>(f(src, dest))</span>
<span id="cb32-14"><a href="#cb32-14"></a>    <span class="cf">return</span> wrapper</span>
<span id="cb32-15"><a href="#cb32-15"></a></span>
<span id="cb32-16"><a href="#cb32-16"></a><span class="at">@check_cache</span></span>
<span id="cb32-17"><a href="#cb32-17"></a><span class="kw">def</span> get_url(src, dest):    </span>
<span id="cb32-18"><a href="#cb32-18"></a>    <span class="co">#&nbsp;Get the data using the urlopen function</span></span>
<span id="cb32-19"><a href="#cb32-19"></a>    response <span class="op">=</span> urlopen(src) </span>
<span id="cb32-20"><a href="#cb32-20"></a>    filedata <span class="op">=</span> response.read().decode(<span class="st">'utf-8'</span>)</span>
<span id="cb32-21"><a href="#cb32-21"></a>     </span>
<span id="cb32-22"><a href="#cb32-22"></a>    <span class="co"># Create any missing directories in dest(ination) path</span></span>
<span id="cb32-23"><a href="#cb32-23"></a>    <span class="co"># -- os.path.join is the reverse of split (as you saw above)</span></span>
<span id="cb32-24"><a href="#cb32-24"></a>    <span class="co"># but it doesn't work with lists... so I had to google how </span></span>
<span id="cb32-25"><a href="#cb32-25"></a>    <span class="co"># to use the 'splat' operator! os.makedirs creates missing </span></span>
<span id="cb32-26"><a href="#cb32-26"></a>    <span class="co"># directories in a path automatically.</span></span>
<span id="cb32-27"><a href="#cb32-27"></a>    dest.parent.mkdir(parents<span class="op">=</span><span class="va">True</span>, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb32-28"><a href="#cb32-28"></a>     </span>
<span id="cb32-29"><a href="#cb32-29"></a>    <span class="cf">with</span> dest.<span class="bu">open</span>(mode<span class="op">=</span><span class="st">'w'</span>) <span class="im">as</span> f:</span>
<span id="cb32-30"><a href="#cb32-30"></a>        f.write(filedata)</span>
<span id="cb32-31"><a href="#cb32-31"></a>         </span>
<span id="cb32-32"><a href="#cb32-32"></a>    <span class="bu">print</span>(<span class="ss">f"Data written to </span><span class="sc">{</span>dest<span class="sc">}</span><span class="ss">!"</span>)</span>
<span id="cb32-33"><a href="#cb32-33"></a>    </span>
<span id="cb32-34"><a href="#cb32-34"></a>    <span class="cf">return</span> dest</span>
<span id="cb32-35"><a href="#cb32-35"></a>        </span>
<span id="cb32-36"><a href="#cb32-36"></a><span class="co"># Using the `return contents` line we make it easy to </span></span>
<span id="cb32-37"><a href="#cb32-37"></a><span class="co"># see what our function is up to.</span></span>
<span id="cb32-38"><a href="#cb32-38"></a>src <span class="op">=</span> get_url(url, out)</span>
<span id="cb32-39"><a href="#cb32-39"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>src<span class="sc">}</span><span class="ss"> is a </span><span class="sc">{</span><span class="bu">type</span>(src)<span class="sc">}</span><span class="ss">."</span>) <span class="co"># &lt;- Note this change!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>data/Listings.csv found locally!
data/Listings.csv is a &lt;class 'pathlib.PosixPath'&gt;.</code></pre>
</div>
</div>
</section>
</section>
<section id="improving-the-documentation" class="level1">
<h1>Improving the Documentation</h1>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-13-contents" aria-controls="callout-13" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Difficulty: Low
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-13" class="callout-13-contents callout-collapse collapse">
<div class="callout-body-container callout-body">

</div>
</div>
</div>
<p>To help people make use of the newly-improved function, we could useful add two types of information to the function:</p>
<ol type="1">
<li>Use the ‘docstring’ support offered by Python so that <code>help(...)</code> gives useful output.</li>
<li>Provided hints to Python about the expected input and output data types.</li>
</ol>
<div id="4e94d7ec" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1"></a><span class="im">from</span> functools <span class="im">import</span> wraps</span>
<span id="cb34-2"><a href="#cb34-2"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb34-3"><a href="#cb34-3"></a><span class="kw">def</span> check_cache(f) <span class="op">-&gt;</span> Path:</span>
<span id="cb34-4"><a href="#cb34-4"></a>    <span class="co">"""</span></span>
<span id="cb34-5"><a href="#cb34-5"></a><span class="co">    Checks if a file exists locally before forwarding to a 'getter'</span></span>
<span id="cb34-6"><a href="#cb34-6"></a><span class="co">    function if it's not found.</span></span>
<span id="cb34-7"><a href="#cb34-7"></a><span class="co">    </span></span>
<span id="cb34-8"><a href="#cb34-8"></a><span class="co">    :param src: any remote file path</span></span>
<span id="cb34-9"><a href="#cb34-9"></a><span class="co">    :type src: str</span></span>
<span id="cb34-10"><a href="#cb34-10"></a><span class="co">    :param dst: any local file path</span></span>
<span id="cb34-11"><a href="#cb34-11"></a><span class="co">    :type dst: str</span></span>
<span id="cb34-12"><a href="#cb34-12"></a><span class="co">    :returns: the local file path</span></span>
<span id="cb34-13"><a href="#cb34-13"></a><span class="co">    :rtype: pathlib.Path</span></span>
<span id="cb34-14"><a href="#cb34-14"></a><span class="co">    """</span></span>
<span id="cb34-15"><a href="#cb34-15"></a>    <span class="at">@wraps</span>(f)</span>
<span id="cb34-16"><a href="#cb34-16"></a>    <span class="kw">def</span> wrapper(<span class="op">*</span>args, <span class="op">**</span>kwargs):</span>
<span id="cb34-17"><a href="#cb34-17"></a>        src  <span class="op">=</span> Path(args[<span class="dv">0</span>])</span>
<span id="cb34-18"><a href="#cb34-18"></a>        dest <span class="op">=</span> Path(args[<span class="dv">1</span>])</span>
<span id="cb34-19"><a href="#cb34-19"></a>        <span class="cf">if</span> dest.exists() <span class="kw">and</span> dest.is_file():</span>
<span id="cb34-20"><a href="#cb34-20"></a>            <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>dest<span class="sc">}</span><span class="ss"> found locally!"</span>)</span>
<span id="cb34-21"><a href="#cb34-21"></a>            <span class="cf">return</span>(dest)</span>
<span id="cb34-22"><a href="#cb34-22"></a>        <span class="cf">else</span>:</span>
<span id="cb34-23"><a href="#cb34-23"></a>            <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>dest<span class="sc">}</span><span class="ss"> not found, downloading!"</span>)</span>
<span id="cb34-24"><a href="#cb34-24"></a>            <span class="cf">return</span>(f(src, dest))</span>
<span id="cb34-25"><a href="#cb34-25"></a>    <span class="cf">return</span> wrapper</span>
<span id="cb34-26"><a href="#cb34-26"></a></span>
<span id="cb34-27"><a href="#cb34-27"></a><span class="at">@check_cache</span></span>
<span id="cb34-28"><a href="#cb34-28"></a><span class="kw">def</span> get_url(src:Path, dst:Path) <span class="op">-&gt;</span> Path:</span>
<span id="cb34-29"><a href="#cb34-29"></a>    <span class="co">"""</span></span>
<span id="cb34-30"><a href="#cb34-30"></a><span class="co">    Reads a remote file (src) and writes it to a local file (dst),</span></span>
<span id="cb34-31"><a href="#cb34-31"></a><span class="co">    returning a Path object that is the location of the saved data.</span></span>
<span id="cb34-32"><a href="#cb34-32"></a><span class="co">    </span></span>
<span id="cb34-33"><a href="#cb34-33"></a><span class="co">    :param src: any remote file path</span></span>
<span id="cb34-34"><a href="#cb34-34"></a><span class="co">    :type src: pathlib.Path</span></span>
<span id="cb34-35"><a href="#cb34-35"></a><span class="co">    :param dst: any local file path</span></span>
<span id="cb34-36"><a href="#cb34-36"></a><span class="co">    :type dst: pathlib.Path</span></span>
<span id="cb34-37"><a href="#cb34-37"></a><span class="co">    :returns: the local file path</span></span>
<span id="cb34-38"><a href="#cb34-38"></a><span class="co">    :rtype: pathlib.Path</span></span>
<span id="cb34-39"><a href="#cb34-39"></a><span class="co">    """</span></span>
<span id="cb34-40"><a href="#cb34-40"></a></span>
<span id="cb34-41"><a href="#cb34-41"></a>    <span class="co">#&nbsp;Get the data using the urlopen function</span></span>
<span id="cb34-42"><a href="#cb34-42"></a>    response <span class="op">=</span> urlopen(src) </span>
<span id="cb34-43"><a href="#cb34-43"></a>    filedata <span class="op">=</span> response.read().decode(<span class="st">'utf-8'</span>)</span>
<span id="cb34-44"><a href="#cb34-44"></a>     </span>
<span id="cb34-45"><a href="#cb34-45"></a>    <span class="co"># Create any missing directories in dest(ination) path</span></span>
<span id="cb34-46"><a href="#cb34-46"></a>    <span class="co"># -- os.path.join is the reverse of split (as you saw above)</span></span>
<span id="cb34-47"><a href="#cb34-47"></a>    <span class="co"># but it doesn't work with lists... so I had to google how </span></span>
<span id="cb34-48"><a href="#cb34-48"></a>    <span class="co"># to use the 'splat' operator! os.makedirs creates missing </span></span>
<span id="cb34-49"><a href="#cb34-49"></a>    <span class="co"># directories in a path automatically.</span></span>
<span id="cb34-50"><a href="#cb34-50"></a>    dst.parent.mkdir(parents<span class="op">=</span><span class="va">True</span>, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb34-51"><a href="#cb34-51"></a>     </span>
<span id="cb34-52"><a href="#cb34-52"></a>    <span class="cf">with</span> dst.<span class="bu">open</span>(mode<span class="op">=</span><span class="st">'w'</span>) <span class="im">as</span> f:</span>
<span id="cb34-53"><a href="#cb34-53"></a>        f.write(filedata)</span>
<span id="cb34-54"><a href="#cb34-54"></a>         </span>
<span id="cb34-55"><a href="#cb34-55"></a>    <span class="bu">print</span>(<span class="ss">f"Data written to </span><span class="sc">{</span>dst<span class="sc">}</span><span class="ss">!"</span>)</span>
<span id="cb34-56"><a href="#cb34-56"></a>    </span>
<span id="cb34-57"><a href="#cb34-57"></a>    <span class="cf">return</span> dst</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="30747210" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1"></a><span class="bu">help</span>(check_cache)</span>
<span id="cb35-2"><a href="#cb35-2"></a><span class="bu">help</span>(get_url)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Help on function check_cache in module __main__:

check_cache(f) -&gt; pathlib.Path
    Checks if a file exists locally before forwarding to a 'getter'
    function if it's not found.

    :param src: any remote file path
    :type src: str
    :param dst: any local file path
    :type dst: str
    :returns: the local file path
    :rtype: pathlib.Path

Help on function get_url in module __main__:

get_url(src: pathlib.Path, dst: pathlib.Path) -&gt; pathlib.Path
    Reads a remote file (src) and writes it to a local file (dst),
    returning a Path object that is the location of the saved data.

    :param src: any remote file path
    :type src: pathlib.Path
    :param dst: any local file path
    :type dst: pathlib.Path
    :returns: the local file path
    :rtype: pathlib.Path
</code></pre>
</div>
</div>
</section>
<section id="packaging-it-up" class="level1">
<h1>Packaging It Up</h1>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-14-contents" aria-controls="callout-14" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Optional Content
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-14" class="callout-14-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This content is optional but will help you to understand how to move functions out of the core namespace and into groups of related tools.</p>
</div>
</div>
</div>
<p>We’re not going to tackle this now, but it’s important that you understand how what we’ve done connects to what we’re <em>about</em> to do, and the concept of a package is the bridge. We’ve already covered this in the pre-recorded lectures, but if you want to actually <em>try</em> to create your own package, the simplest way to do this is to:</p>
<ol type="1">
<li>Copy the two functions above (<code>check_cache</code> and <code>get_url</code>) into a new file called, for instance, <code>utils.py</code>.</li>
<li>Make sure you delete this function from the current ‘namespace’ (<code>del(get_url)</code>) by which I mean that the running <code>help(get_url)</code> should give you an error!.</li>
<li>Try importing the function from the file: <code>from utils import get_url</code> and run the <code>help(get_url)</code> code again.</li>
</ol>
<p>Assuming that you’ve done everything correctly, we’ve now brought in code from another file without having to write it into our main Python script file. In Python, many of the most complex libraries are spread across the equivalent of <em>many</em> <code>utils.py</code> files, but on top of <em>that</em> when we import and run them they are also creating objects from classes defined in those files.</p>
</section>
<section id="classes-and-inheritance" class="level1">
<h1>Classes and Inheritance</h1>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-15-contents" aria-controls="callout-15" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Optional Content
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-15" class="callout-15-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This content is optional but will help you to understand how object-oriented programming works and how you can develop your own classes.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-16-contents" aria-controls="callout-16" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Difficulty: 🤯.
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-16" class="callout-16-contents callout-collapse collapse">
<div class="callout-body-container callout-body">

</div>
</div>
</div>
<p>In Python, many of the most complex libraries are spread across the equivalent of <em>many</em> <code>utils.py</code> files, but on top of <em>that</em> when we import and run them they are also creating objects from classes defined in those files. What we now want to do is use a fairly simple example using a basic representation of Airbhb listings that allow us to explore how classes work through inheritance from parents and can extend of overwrite the functionality provided by the parent class. We’ll need this understanding in order to grasp how Pandas and GeoPandas work specifically, but also how Python works more generally.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
🔗 Connections
</div>
</div>
<div class="callout-body-container callout-body">
<p>This will draw on what you’ve learned in the lectures about <a href="https://jreades.github.io/fsds/sessions/week5.html#pre-recorded-lectures">Methods</a>, <a href="https://jreades.github.io/fsds/sessions/week5.html#pre-recorded-lectures">Classes</a>, and <a href="https://jreades.github.io/fsds/sessions/week5.html#pre-recorded-lectures">Design</a>. You will also find the Code Camp <a href="https://jreades.github.io/code-camp/lessons/Classes.html">Classes</a> session useful.</p>
</div>
</div>
<p>We want to create a set of classes to ‘help’ Airbnb manage bookings – these will necessarily be highly simplified and are intended more as a teaching resource than a demonstration of outstanding Object-Oriented Design; however, it’s my hope that you’ll see how classes and objects can support programming and application development.</p>
<p>We’re also going to make use of a few features of Python:</p>
<ul>
<li>You can access the class name of an instance using: <code>self.__class__.__name__</code>. And here’s one key point: <code>self</code> refers to the instance (to <em>this</em> particular shape that I’ve created), not to the class in general (to <em>all</em> objects of the same class)… we’ll see why this matters.</li>
<li>You can raise your own exceptions easily if you don’t want to implement a particular method yet. This is giving you control over how your code behaves when something goes ‘wrong’ – as we’ve covered elsewhere sometimes an error is ‘expected’ and we want to handle the <em>exception</em>, other times it is ‘unexpected’ and we’re going to let Python fail so that the user knows something is seriously wrong.</li>
<li>You can have an ‘abstract’ base class that does nothing except provide a template for the ‘real’ classes so that different types of listings can be used interchangeably. This is quite an advanced feature, but it gives our script a lot more flexibility: we don’t need to worry about whether we’re working with a flat, house, or houseboat because they are defined in a way that allows this flexibility.</li>
</ul>
<section id="abstract-base-class" class="level2">
<h2 class="anchored" data-anchor-id="abstract-base-class">Abstract Base Class</h2>
<p>This class appears to do very little, but there are two things to notice:</p>
<ol type="1">
<li>It provides a constructor (<code>__init__</code>) that sets the <code>listing_type</code> to the name of the class automatically (so a <code>flat</code> object has <code>shape_type='Flat'</code>) and it stores the critical accommodation details.</li>
<li>It provides methods (which only raise exceptions) that will allow all listings to be used interchangeably in the right context (e.g.&nbsp;determining availability).</li>
</ol>
<div id="0e938ea9" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1"></a><span class="co"># We first need to install a library for managing</span></span>
<span id="cb37-2"><a href="#cb37-2"></a><span class="co"># availability in a highly optimised way.</span></span>
<span id="cb37-3"><a href="#cb37-3"></a><span class="cf">try</span>:</span>
<span id="cb37-4"><a href="#cb37-4"></a>    <span class="im">from</span> bitarray <span class="im">import</span> bitarray</span>
<span id="cb37-5"><a href="#cb37-5"></a><span class="cf">except</span>:</span>
<span id="cb37-6"><a href="#cb37-6"></a>    <span class="op">!</span> pip install bitarray</span>
<span id="cb37-7"><a href="#cb37-7"></a>    <span class="im">from</span> bitarray <span class="im">import</span> bitarray</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="344611bf" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1"></a><span class="im">from</span> bitarray <span class="im">import</span> bitarray</span>
<span id="cb38-2"><a href="#cb38-2"></a><span class="co"># Base class shape</span></span>
<span id="cb38-3"><a href="#cb38-3"></a><span class="kw">class</span> listing(<span class="bu">object</span>): <span class="co"># Inherit from base class </span></span>
<span id="cb38-4"><a href="#cb38-4"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, name:<span class="bu">str</span>, price:<span class="bu">float</span>, bedrooms:<span class="bu">int</span>, availability:bitarray<span class="op">=</span>bitarray(<span class="dv">14</span>)):</span>
<span id="cb38-5"><a href="#cb38-5"></a>        <span class="va">self</span>.listing_type <span class="op">=</span> <span class="va">self</span>.__class__.<span class="va">__name__</span>.capitalize()</span>
<span id="cb38-6"><a href="#cb38-6"></a>        <span class="va">self</span>.listing_name <span class="op">=</span> name</span>
<span id="cb38-7"><a href="#cb38-7"></a>        <span class="va">self</span>.listing_price <span class="op">=</span> price</span>
<span id="cb38-8"><a href="#cb38-8"></a>        <span class="va">self</span>.listing_bedrooms <span class="op">=</span> bedrooms</span>
<span id="cb38-9"><a href="#cb38-9"></a>        <span class="va">self</span>.listing_availability <span class="op">=</span> availability</span>
<span id="cb38-10"><a href="#cb38-10"></a>    </span>
<span id="cb38-11"><a href="#cb38-11"></a>    <span class="kw">def</span> name(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb38-12"><a href="#cb38-12"></a>        <span class="cf">raise</span> <span class="pp">Exception</span>(<span class="st">"Unimplemented method error."</span>)</span>
<span id="cb38-13"><a href="#cb38-13"></a></span>
<span id="cb38-14"><a href="#cb38-14"></a>    <span class="kw">def</span> price(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="bu">float</span>:</span>
<span id="cb38-15"><a href="#cb38-15"></a>        <span class="cf">return</span> <span class="va">self</span>.listing_price</span>
<span id="cb38-16"><a href="#cb38-16"></a>    </span>
<span id="cb38-17"><a href="#cb38-17"></a>    <span class="kw">def</span> bedrooms(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb38-18"><a href="#cb38-18"></a>        <span class="cf">return</span> <span class="va">self</span>.listing_bedrooms</span>
<span id="cb38-19"><a href="#cb38-19"></a>    </span>
<span id="cb38-20"><a href="#cb38-20"></a>    <span class="kw">def</span> is_available(<span class="va">self</span>, requested:bitarray) <span class="op">-&gt;</span> bitarray:</span>
<span id="cb38-21"><a href="#cb38-21"></a>        <span class="cf">return</span> bitarray(<span class="va">self</span>.listing_availability <span class="op">&amp;</span> requested).<span class="bu">any</span>()</span>
<span id="cb38-22"><a href="#cb38-22"></a></span>
<span id="cb38-23"><a href="#cb38-23"></a>    <span class="kw">def</span> <span class="bu">type</span>(<span class="va">self</span>):</span>
<span id="cb38-24"><a href="#cb38-24"></a>        <span class="cf">return</span>(<span class="va">self</span>.listing_type)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can now create a new listing object (an <em>instance</em> of the shape class) but we can’t do much that is useful with it:</p>
<div id="4c9dd460" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1"></a>l <span class="op">=</span> listing(<span class="st">'A listing'</span>, <span class="fl">25.00</span>, <span class="dv">3</span>, bitarray(<span class="dv">14</span>))</span>
<span id="cb39-2"><a href="#cb39-2"></a></span>
<span id="cb39-3"><a href="#cb39-3"></a><span class="cf">try</span>: </span>
<span id="cb39-4"><a href="#cb39-4"></a>    <span class="bu">print</span>(<span class="ss">f"I am a </span><span class="sc">{</span>l<span class="sc">.</span><span class="bu">type</span>()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb39-5"><a href="#cb39-5"></a>    <span class="bu">print</span>(<span class="ss">f"My name is </span><span class="sc">{</span>l<span class="sc">.</span>name()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb39-6"><a href="#cb39-6"></a><span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb39-7"><a href="#cb39-7"></a>    <span class="bu">print</span>(<span class="ss">f"Error: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>I am a Listing
Error: Unimplemented method error.</code></pre>
</div>
</div>
</section>
<section id="flat" class="level2">
<h2 class="anchored" data-anchor-id="flat">Flat</h2>
<p>Implements a flat:</p>
<ol type="1">
<li>Adds ‘Flat:’ or ‘Studio:’ to all requests for the name.</li>
<li>Adds a ‘floor’ method to track what floor the flat is on.</li>
<li>Checks if the number of ‘bedrooms’ is 0 (in which case it’s a ‘Studio:’) or more (in which case it’s a ‘Flat:’).</li>
</ol>
<div class="tabset-margin-container"></div><div class="panel-tabset qna-question">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">Question</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">Answer</a></li></ul>
<div class="tab-content qna-question">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<p>Can you work out the missing elements that will allow you to create a flat class? We’ll want to know the floor and whether we’re dealing with a Flat or a Studio by looking at the name of the listing.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1"></a><span class="co"># Flat class</span></span>
<span id="cb41-2"><a href="#cb41-2"></a><span class="kw">class</span> flat(listing): <span class="co"># Inherit from listing </span></span>
<span id="cb41-3"><a href="#cb41-3"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, name:<span class="bu">str</span>, price:<span class="bu">float</span>, bedrooms:<span class="bu">int</span>, floor:<span class="bu">int</span>, availability:bitarray<span class="op">=</span>bitarray(<span class="dv">10</span>)):</span>
<span id="cb41-4"><a href="#cb41-4"></a>        <span class="bu">super</span>().<span class="fu">__init__</span>(name, price, bedrooms, availability)</span>
<span id="cb41-5"><a href="#cb41-5"></a>        <span class="va">self</span>.listing_floor <span class="op">=</span> floor</span>
<span id="cb41-6"><a href="#cb41-6"></a></span>
<span id="cb41-7"><a href="#cb41-7"></a><span class="co"># If you've done everything correctly then</span></span>
<span id="cb41-8"><a href="#cb41-8"></a><span class="co"># you will no longer get an error here...</span></span>
<span id="cb41-9"><a href="#cb41-9"></a>f <span class="op">=</span> flat(<span class="st">'Room With a View'</span>, <span class="fl">73.00</span>, <span class="dv">0</span>, )</span>
<span id="cb41-10"><a href="#cb41-10"></a></span>
<span id="cb41-11"><a href="#cb41-11"></a><span class="cf">try</span>: </span>
<span id="cb41-12"><a href="#cb41-12"></a>    <span class="bu">print</span>(<span class="ss">f"I am a </span><span class="sc">{</span>f<span class="sc">.</span><span class="bu">type</span>()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb41-13"><a href="#cb41-13"></a>    <span class="bu">print</span>(<span class="ss">f"My name is </span><span class="sc">{</span>f<span class="sc">.</span>name()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb41-14"><a href="#cb41-14"></a><span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb41-15"><a href="#cb41-15"></a>    <span class="bu">print</span>(<span class="ss">f"Error: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1"></a><span class="co"># Flat class</span></span>
<span id="cb42-2"><a href="#cb42-2"></a><span class="kw">class</span> flat(listing): <span class="co"># Inherit from listing </span></span>
<span id="cb42-3"><a href="#cb42-3"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, name:<span class="bu">str</span>, price:<span class="bu">float</span>, bedrooms:<span class="bu">int</span>, floor:<span class="bu">int</span>, availability:bitarray<span class="op">=</span>bitarray(<span class="dv">14</span>)):</span>
<span id="cb42-4"><a href="#cb42-4"></a>        <span class="bu">super</span>().<span class="fu">__init__</span>(name, price, bedrooms, availability)</span>
<span id="cb42-5"><a href="#cb42-5"></a>        <span class="va">self</span>.listing_floor <span class="op">=</span> floor</span>
<span id="cb42-6"><a href="#cb42-6"></a>    </span>
<span id="cb42-7"><a href="#cb42-7"></a>    <span class="kw">def</span> name(<span class="va">self</span>):</span>
<span id="cb42-8"><a href="#cb42-8"></a>        <span class="cf">if</span> <span class="va">self</span>.listing_bedrooms <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb42-9"><a href="#cb42-9"></a>            <span class="cf">return</span> <span class="ss">f"Studio: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>listing_name<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb42-10"><a href="#cb42-10"></a>        <span class="cf">else</span>:</span>
<span id="cb42-11"><a href="#cb42-11"></a>            <span class="cf">return</span> <span class="ss">f"Flat: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>listing_name<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb42-12"><a href="#cb42-12"></a></span>
<span id="cb42-13"><a href="#cb42-13"></a><span class="co"># If you've done everything correctly then</span></span>
<span id="cb42-14"><a href="#cb42-14"></a><span class="co"># you will no longer get an error here...</span></span>
<span id="cb42-15"><a href="#cb42-15"></a>f <span class="op">=</span> flat(<span class="st">'Room With a View'</span>, <span class="fl">73.00</span>, <span class="dv">0</span>, <span class="dv">5</span>, bitarray(<span class="st">'11000001100000'</span>))</span>
<span id="cb42-16"><a href="#cb42-16"></a></span>
<span id="cb42-17"><a href="#cb42-17"></a><span class="cf">try</span>: </span>
<span id="cb42-18"><a href="#cb42-18"></a>    <span class="bu">print</span>(<span class="ss">f"I am a </span><span class="sc">{</span>f<span class="sc">.</span><span class="bu">type</span>()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb42-19"><a href="#cb42-19"></a>    <span class="bu">print</span>(<span class="ss">f"My name is </span><span class="sc">{</span>f<span class="sc">.</span>name()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb42-20"><a href="#cb42-20"></a><span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb42-21"><a href="#cb42-21"></a>    <span class="bu">print</span>(<span class="ss">f"Error: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>I am a Flat
My name is Studio: Room With a View</code></pre>
</div>
</div>
</div>
<p>You should get:</p>
<ul>
<li>I am a <code>Flat</code></li>
<li>My name is <code>Studio: Room With a View</code></li>
</ul>
<p>If you were to create a <em>second</em> flat listing you can see how things change automatically based on the attributes:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1"></a>f2 <span class="op">=</span> flat(<span class="st">'Room With a Better View'</span>, <span class="fl">123.00</span>, <span class="dv">2</span>, <span class="dv">6</span>, bitarray(<span class="st">'10000001000000'</span>))</span>
<span id="cb44-2"><a href="#cb44-2"></a><span class="bu">print</span>(<span class="ss">f"I am a `</span><span class="sc">{</span>f2<span class="sc">.</span><span class="bu">type</span>()<span class="sc">}</span><span class="ss">`"</span>)</span>
<span id="cb44-3"><a href="#cb44-3"></a><span class="bu">print</span>(<span class="ss">f"My name is `</span><span class="sc">{</span>f2<span class="sc">.</span>name()<span class="sc">}</span><span class="ss">`"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>I am a <code>Flat</code></li>
<li>My name is <code>Flat: Room With a Better View</code></li>
</ul>
</section>
<section id="houseboat" class="level2">
<h2 class="anchored" data-anchor-id="houseboat">Houseboat</h2>
<p>Implements a houseboat listing:</p>
<ol type="1">
<li>Adds an ‘on_water’ boolean attribute.</li>
<li>Adds ‘Floating Palace:’ to the name if the houseboat is on water, or ‘Grounded!’ if it’s not.</li>
</ol>
<div class="tabset-margin-container"></div><div class="panel-tabset qna-question">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">Question</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">Answer</a></li></ul>
<div class="tab-content qna-question">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<p>Can you work out the missing elements that will allow you to create a houseboat class?</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1"></a><span class="co"># Houseboat class</span></span>
<span id="cb45-2"><a href="#cb45-2"></a><span class="kw">class</span> houseboat(listing): <span class="co"># Inherit from shape</span></span>
<span id="cb45-3"><a href="#cb45-3"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, ...):</span>
<span id="cb45-4"><a href="#cb45-4"></a>        <span class="co"># Something...</span></span>
<span id="cb45-5"><a href="#cb45-5"></a></span>
<span id="cb45-6"><a href="#cb45-6"></a>    <span class="kw">def</span> on_water(<span class="va">self</span>):</span>
<span id="cb45-7"><a href="#cb45-7"></a>        <span class="co"># Something...</span></span>
<span id="cb45-8"><a href="#cb45-8"></a></span>
<span id="cb45-9"><a href="#cb45-9"></a><span class="co"># If you've done everything correctly then</span></span>
<span id="cb45-10"><a href="#cb45-10"></a><span class="co"># you will no longer get an error here...</span></span>
<span id="cb45-11"><a href="#cb45-11"></a>h <span class="op">=</span> houseboat(<span class="dv">15</span>)</span>
<span id="cb45-12"><a href="#cb45-12"></a></span>
<span id="cb45-13"><a href="#cb45-13"></a><span class="cf">try</span>: </span>
<span id="cb45-14"><a href="#cb45-14"></a>    <span class="bu">print</span>(<span class="ss">f"I am a </span><span class="sc">{</span>h<span class="sc">.</span><span class="bu">type</span>()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb45-15"><a href="#cb45-15"></a>    <span class="bu">print</span>(<span class="ss">f"My name is </span><span class="sc">{</span>h<span class="sc">.</span>name()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb45-16"><a href="#cb45-16"></a>    <span class="cf">if</span> h.on_water():</span>
<span id="cb45-17"><a href="#cb45-17"></a>        <span class="bu">print</span>(<span class="st">"Where I expect a houseboat to be."</span>)</span>
<span id="cb45-18"><a href="#cb45-18"></a>    <span class="cf">else</span>:</span>
<span id="cb45-19"><a href="#cb45-19"></a>        <span class="bu">print</span>(<span class="st">"Something has gone very wrong!"</span>)</span>
<span id="cb45-20"><a href="#cb45-20"></a><span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb45-21"><a href="#cb45-21"></a>    <span class="bu">print</span>(<span class="ss">f"Error: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1"></a><span class="co"># Houseboat class</span></span>
<span id="cb46-2"><a href="#cb46-2"></a><span class="kw">class</span> houseboat(listing): <span class="co"># Inherit from shape</span></span>
<span id="cb46-3"><a href="#cb46-3"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, name:<span class="bu">str</span>, price:<span class="bu">float</span>, bedrooms:<span class="bu">int</span>, availability:bitarray<span class="op">=</span>bitarray(<span class="dv">14</span>), onwater:<span class="bu">bool</span><span class="op">=</span><span class="va">True</span>):</span>
<span id="cb46-4"><a href="#cb46-4"></a>        <span class="bu">super</span>().<span class="fu">__init__</span>(name, price, bedrooms, availability)</span>
<span id="cb46-5"><a href="#cb46-5"></a>        <span class="va">self</span>.listing_onwater <span class="op">=</span> onwater</span>
<span id="cb46-6"><a href="#cb46-6"></a></span>
<span id="cb46-7"><a href="#cb46-7"></a>    <span class="kw">def</span> name(<span class="va">self</span>):</span>
<span id="cb46-8"><a href="#cb46-8"></a>        <span class="cf">if</span> <span class="va">self</span>.on_water():</span>
<span id="cb46-9"><a href="#cb46-9"></a>            <span class="cf">return</span> <span class="ss">f"Floating Palace: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>listing_name<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb46-10"><a href="#cb46-10"></a>        <span class="cf">else</span>:</span>
<span id="cb46-11"><a href="#cb46-11"></a>            <span class="cf">return</span> <span class="ss">f"Grounded! </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>listing_name<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb46-12"><a href="#cb46-12"></a></span>
<span id="cb46-13"><a href="#cb46-13"></a>    <span class="kw">def</span> on_water(<span class="va">self</span>):</span>
<span id="cb46-14"><a href="#cb46-14"></a>        <span class="cf">return</span> <span class="va">self</span>.listing_onwater</span>
<span id="cb46-15"><a href="#cb46-15"></a></span>
<span id="cb46-16"><a href="#cb46-16"></a><span class="co"># If you've done everything correctly then</span></span>
<span id="cb46-17"><a href="#cb46-17"></a><span class="co"># you will no longer get an error here...</span></span>
<span id="cb46-18"><a href="#cb46-18"></a>h <span class="op">=</span> houseboat(<span class="st">'Bargemaster'</span>, <span class="fl">5.25</span>, <span class="dv">1</span>)</span>
<span id="cb46-19"><a href="#cb46-19"></a></span>
<span id="cb46-20"><a href="#cb46-20"></a><span class="cf">try</span>: </span>
<span id="cb46-21"><a href="#cb46-21"></a>    <span class="bu">print</span>(<span class="ss">f"I am a </span><span class="sc">{</span>h<span class="sc">.</span><span class="bu">type</span>()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb46-22"><a href="#cb46-22"></a>    <span class="bu">print</span>(<span class="ss">f"My name is </span><span class="sc">{</span>h<span class="sc">.</span>name()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb46-23"><a href="#cb46-23"></a>    <span class="cf">if</span> h.on_water():</span>
<span id="cb46-24"><a href="#cb46-24"></a>        <span class="bu">print</span>(<span class="st">"Where I expect a houseboat to be."</span>)</span>
<span id="cb46-25"><a href="#cb46-25"></a>    <span class="cf">else</span>:</span>
<span id="cb46-26"><a href="#cb46-26"></a>        <span class="bu">print</span>(<span class="st">"Something has gone very wrong!"</span>)</span>
<span id="cb46-27"><a href="#cb46-27"></a><span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb46-28"><a href="#cb46-28"></a>    <span class="bu">print</span>(<span class="ss">f"Error: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>I am a Houseboat
My name is Floating Palace: Bargemaster
Where I expect a houseboat to be.</code></pre>
</div>
</div>
</div>
</section>
<section id="availability" class="level2">
<h2 class="anchored" data-anchor-id="availability">Availability</h2>
<p>The last thing we want to do is look at how (and why) we’ve recorded availability. Let’s pretend that this can only be measured 2 weeks in advance (i.e.&nbsp;14 days). Let’s look at how the <code>bitarray</code> can help us here:</p>
<div id="5fd48dab" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1"></a>b1 <span class="op">=</span> bitarray(<span class="dv">14</span>)</span>
<span id="cb48-2"><a href="#cb48-2"></a>b2 <span class="op">=</span> bitarray(<span class="st">'11111111111111'</span>)</span>
<span id="cb48-3"><a href="#cb48-3"></a>b3 <span class="op">=</span> bitarray(<span class="st">'01010101010101'</span>)</span>
<span id="cb48-4"><a href="#cb48-4"></a></span>
<span id="cb48-5"><a href="#cb48-5"></a><span class="bu">print</span>(b1 <span class="op">&amp;</span> b2)</span>
<span id="cb48-6"><a href="#cb48-6"></a><span class="bu">print</span>(b2 <span class="op">&amp;</span> b3)</span>
<span id="cb48-7"><a href="#cb48-7"></a><span class="bu">print</span>(b1 <span class="op">|</span> b2)</span>
<span id="cb48-8"><a href="#cb48-8"></a><span class="bu">print</span>(b1 <span class="op">|</span> b3)</span>
<span id="cb48-9"><a href="#cb48-9"></a><span class="bu">print</span>(bitarray(b1 <span class="op">&amp;</span> b3).<span class="bu">any</span>())</span>
<span id="cb48-10"><a href="#cb48-10"></a><span class="bu">print</span>(bitarray(b1 <span class="op">|</span> b3).<span class="bu">any</span>())</span>
<span id="cb48-11"><a href="#cb48-11"></a><span class="bu">print</span>(bitarray(b1 <span class="op">&amp;</span> b3).count())</span>
<span id="cb48-12"><a href="#cb48-12"></a><span class="bu">print</span>(bitarray(b1 <span class="op">|</span> b3).count())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>bitarray('00000000000000')
bitarray('01010101010101')
bitarray('11111111111111')
bitarray('01010101010101')
False
True
0
7</code></pre>
</div>
</div>
<p>Does it now make sense why the <code>is_available</code> is set up the way it is?</p>
</section>
<section id="pulling-it-all-together" class="level2">
<h2 class="anchored" data-anchor-id="pulling-it-all-together">Pulling It All Together</h2>
<p>Let’s finish with a demonstration of how we can use these classes in some kind of application:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset qna-question">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">Question</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">Answer</a></li></ul>
<div class="tab-content qna-question">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div class="sourceCode" id="cb50"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1"></a>f1 <span class="op">=</span> flat(<span class="st">'Room With a View'</span>, <span class="fl">73.00</span>, <span class="dv">0</span>, <span class="dv">5</span>, bitarray(<span class="st">'11000001100000'</span>))</span>
<span id="cb50-2"><a href="#cb50-2"></a>f2 <span class="op">=</span> flat(<span class="st">'Room With a Better View'</span>, <span class="fl">123.00</span>, <span class="dv">2</span>, <span class="dv">6</span>, bitarray(<span class="st">'10000001000000'</span>))</span>
<span id="cb50-3"><a href="#cb50-3"></a>h1 <span class="op">=</span> houseboat(<span class="st">'Bargemaster'</span>, <span class="fl">5.25</span>, <span class="dv">1</span>)</span>
<span id="cb50-4"><a href="#cb50-4"></a>h2 <span class="op">=</span> houseboat(<span class="st">'Sinking'</span>, <span class="fl">15.25</span>, <span class="dv">1</span>, bitarray(<span class="st">'11111110000000'</span>))</span>
<span id="cb50-5"><a href="#cb50-5"></a></span>
<span id="cb50-6"><a href="#cb50-6"></a>listings <span class="op">=</span> [f1, f2, h1, h2]</span>
<span id="cb50-7"><a href="#cb50-7"></a></span>
<span id="cb50-8"><a href="#cb50-8"></a><span class="co"># You are looking for availability on Mondays...</span></span>
<span id="cb50-9"><a href="#cb50-9"></a>search <span class="op">=</span> bitarray( ?? )</span>
<span id="cb50-10"><a href="#cb50-10"></a></span>
<span id="cb50-11"><a href="#cb50-11"></a>available <span class="op">=</span> [x <span class="cf">for</span> x <span class="kw">in</span> listings <span class="cf">if</span> ??]</span>
<span id="cb50-12"><a href="#cb50-12"></a></span>
<span id="cb50-13"><a href="#cb50-13"></a><span class="bu">print</span>(<span class="st">"The following options are available: "</span>)</span>
<span id="cb50-14"><a href="#cb50-14"></a><span class="cf">for</span> a <span class="kw">in</span> available:</span>
<span id="cb50-15"><a href="#cb50-15"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\t</span><span class="sc">{</span>a<span class="sc">.</span>name()<span class="sc">}</span><span class="ss"> is available for £</span><span class="sc">{</span>a<span class="sc">.</span>price()<span class="sc">:,.2f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1"></a>f1 <span class="op">=</span> flat(<span class="st">'Room With a View'</span>, <span class="fl">73.00</span>, <span class="dv">0</span>, <span class="dv">5</span>, bitarray(<span class="st">'11000001100000'</span>))</span>
<span id="cb51-2"><a href="#cb51-2"></a>f2 <span class="op">=</span> flat(<span class="st">'Room With a Better View'</span>, <span class="fl">123.00</span>, <span class="dv">2</span>, <span class="dv">6</span>, bitarray(<span class="st">'10000001000000'</span>))</span>
<span id="cb51-3"><a href="#cb51-3"></a>h1 <span class="op">=</span> houseboat(<span class="st">'Bargemaster'</span>, <span class="fl">5.25</span>, <span class="dv">1</span>)</span>
<span id="cb51-4"><a href="#cb51-4"></a>h2 <span class="op">=</span> houseboat(<span class="st">'Sinking'</span>, <span class="fl">15.25</span>, <span class="dv">1</span>, bitarray(<span class="st">'11111110000000'</span>))</span>
<span id="cb51-5"><a href="#cb51-5"></a></span>
<span id="cb51-6"><a href="#cb51-6"></a>listings <span class="op">=</span> [f1, f2, h1, h2]</span>
<span id="cb51-7"><a href="#cb51-7"></a></span>
<span id="cb51-8"><a href="#cb51-8"></a><span class="co"># You are looking for availability on Mondays...</span></span>
<span id="cb51-9"><a href="#cb51-9"></a>search <span class="op">=</span> bitarray(<span class="st">'01000000100000'</span>)</span>
<span id="cb51-10"><a href="#cb51-10"></a></span>
<span id="cb51-11"><a href="#cb51-11"></a>available <span class="op">=</span> [x <span class="cf">for</span> x <span class="kw">in</span> listings <span class="cf">if</span> x.is_available(search)]</span>
<span id="cb51-12"><a href="#cb51-12"></a></span>
<span id="cb51-13"><a href="#cb51-13"></a><span class="bu">print</span>(<span class="st">"The following options are available: "</span>)</span>
<span id="cb51-14"><a href="#cb51-14"></a><span class="cf">for</span> a <span class="kw">in</span> available:</span>
<span id="cb51-15"><a href="#cb51-15"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\t</span><span class="sc">{</span>a<span class="sc">.</span>name()<span class="sc">}</span><span class="ss"> is available for £</span><span class="sc">{</span>a<span class="sc">.</span>price()<span class="sc">:,.2f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>The following options are available: 
    Studio: Room With a View is available for £73.00
    Floating Palace: Sinking is available for £15.25</code></pre>
</div>
</div>
</div>
<p>You should get that <code>Studio: Room With a View</code> and <code>Floating Palace: Sinking</code> are available.</p>


</section>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Slight exception to this: the macOS <em>also</em> recognises <code>:</code> as a path separator<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 2022–2025, Jon Reades</p>
</div>   
    <div class="nav-footer-center">
<p><img src="../img/logo/logo_only_sm.png" height="25"> Foundations of Spatial Data Science</p>
<div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/jreades/fsds/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/jreades/fsds">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://bsky.app/profile/jreades.bsky.social/">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>